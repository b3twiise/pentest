(function(){function j(b,a,c){return function(){var e=b.readyState,d={id:a.id,readyState:e};2<=e&&(d.status=b.status,d.statusText=b.statusText,d.allResponseHeaders=b.getAllResponseHeaders());3<=e&&(d.responseText=b.responseText);c.sendAsyncMessage("websecurify-xmlhttprequest-onreadystatechange",d)}}function k(b,a,c){return function(){var e=b.readyState,d={id:a.id,readyState:e};2<=e&&(d.status=b.status,d.statusText=b.statusText,d.allResponseHeaders=b.getAllResponseHeaders());3<=e&&(d.responseText=
b.responseText);c.sendAsyncMessage("websecurify-xmlhttprequest-onload",d)}}function l(b,a){return function(){a.sendAsyncMessage("websecurify-xmlhttprequest-onerror",{id:b.id})}}function m(b,a){return function(){a.sendAsyncMessage("websecurify-xmlhttprequest-onabort",{id:b.id})}}function g(b){var a=JSON.parse(b.json.json);if(/https?:\/\//i.test(a.url)){var c=new XMLHttpRequest;c.open(a.method,a.url,!0);if("withCredentials"in a&&null!=a.withCredentials)try{c.withCredentials=a.withCredentials}catch(e){Components.utils.reportError(e),
Components.utils.reportError("cannot set withCredentials parameter with value "+a.withCredentials+" on XMLHttpRequest object")}if("overrideMimeType"in a&&null!=a.overrideMimeType)try{c.overrideMimeType(a.overrideMimeType)}catch(d){Components.utils.reportError(d),Components.utils.reportError("cannot call overrideMimeType function with parameter "+a.overrideMimeType+" on XMLHttpRequest object")}if("headers"in a&&null!=a.headers){var h=a.headers,f;for(f in h){var i=h[f];try{c.setRequestHeader(f,i)}catch(g){Components.utils.reportError(g),
Components.utils.reportError("cannot set request header "+f+" with value "+i+" on XMLHttpRequest object")}}}c.setRequestHeader("Origin",b.target.currentURI.prePath);c.onreadystatechange=j(c,a,b.target.messageManager);c.onload=k(c,a,b.target.messageManager);c.onerror=l(a,b.target.messageManager);c.onabort=m(a,b.target.messageManager);c.send(a.data)}}addEventListener("load",function(b){b.target==document&&(messageManager.loadFrameScript("chrome://org.gnucitizen.websecurify.firefox/content/imp/xmlhttprequestDispatcherClient.js",
!0),messageManager.addMessageListener("websecurify-xmlhttprequest",g))},!1)})();
