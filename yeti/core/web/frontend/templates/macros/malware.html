{% import "macros/generic.html" as macros %}
{% macro display_table(n, obj) -%}

<table class="table table-condensed">
  <tr><th>Name</th><th>Link</th><th>Family</th><th>Aliases</th></tr>
  {% for type, entry in n.items() if "Malware" in type %}
    {% for link, node in entry %}
    <tr>
      <td><a href="{{ url_for("frontend.EntityView:get", id=node.id)}}">{{node.name}}</a></td>
      <td>{{link.description}}</td>
      <td>{{ node.family.name }}</td>
      <td>{{ macros.display_tags(node.aliases)}}</td>
      <td>{{node.context|join(', ', attribute='source')}}</td>
    </tr>
    {% endfor %}
  {%endfor%}
</table>
<a href="{{ url_for('frontend.EntityView:new_subclass', subclass="malware", bind=obj.id, type=obj.type.lower()) }}" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Bind new Malware</a>


{%- endmacro %}
